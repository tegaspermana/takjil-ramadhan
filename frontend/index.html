<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Takjil Ramadhan 1447H</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
    rel="stylesheet" />
  <style>
    * {
      font-family: 'Poppins', sans-serif;
    }

    .date-card {
      transition: all 0.2s ease;
    }

    .date-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
    }

    .status-available {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    }

    .status-partial {
      background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
    }

    .status-full {
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
    }

    .status-locked {
      background: linear-gradient(135deg, #9ca3af 0%, #6b7280 100%);
    }

    .modal-animation {
      animation: modalFadeIn 0.3s ease-out;
    }

    @keyframes modalFadeIn {
      from {
        opacity: 0;
        transform: translateY(-20px) scale(0.95);
      }

      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .loading-spinner {
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }
  </style>
</head>

<body class="bg-gradient-to-br from-emerald-50 to-amber-50 min-h-screen">
  <!-- Header -->
  <header class="bg-gradient-to-r from-emerald-600 to-green-700 text-white shadow-lg">
    <div class="container mx-auto px-4 py-6">
      <div class="flex flex-col md:flex-row justify-between items-center">
        <div class="flex items-center space-x-4 mb-4 md:mb-0">
          <div class="bg-white/20 p-3 rounded-xl">
            <i class="fas fa-mosque text-2xl"></i>
          </div>
          <div>
            <h1 class="text-2xl md:text-3xl font-bold">Takjil Ramadhan 1447H</h1>
            <p class="text-emerald-100 text-sm md:text-base">Pendaftaran Pengisi Takjil</p>
          </div>
        </div>
        <div class="flex items-center space-x-4">
          <a href="/admin" class="bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg transition">
            <i class="fas fa-lock mr-2"></i>
            <span>Admin</span>
          </a>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="container mx-auto px-4 py-8">
    <!-- Loading State -->
    <div id="loading" class="text-center py-12">
      <div class="inline-block loading-spinner rounded-full h-12 w-12 border-b-2 border-emerald-600"></div>
      <p class="mt-4 text-gray-600">Memuat aplikasi...</p>
    </div>

    <!-- App Content (initially hidden) -->
    <div id="app" class="hidden">
      <!-- Information Panel -->
      <div class="bg-gradient-to-r from-emerald-50 to-amber-50 rounded-2xl border border-emerald-200 p-6">
        <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
          <i class="fas fa-lightbulb mr-3 text-amber-600"></i>
          Informasi Penting
        </h3>
        <ul class="space-y-3 text-gray-700">
          <li class="flex items-start">
            <i class="fas fa-check-circle text-emerald-500 mt-1 mr-3"></i>
            <span>Setiap tanggal maksimal diisi oleh 2 keluarga</span>
          </li>
          <li class="flex items-start">
            <i class="fas fa-check-circle text-emerald-500 mt-1 mr-3"></i>
            <span>Tanggal 21-30 akan dibuka setelah pertengahan Ramadhan</span>
          </li>
          <li class="flex items-start">
            <i class="fas fa-check-circle text-emerald-500 mt-1 mr-3"></i>
            <span>Pastikan nomor WhatsApp aktif untuk konfirmasi</span>
          </li>
          <li class="flex items-start">
            <i class="fas fa-check-circle text-emerald-500 mt-1 mr-3"></i>
            <span>Admin akan menghubungi H-1 sebelum tanggal takjil</span>
          </li>
          <li class="flex items-start">
            <i class="fas fa-check-circle text-emerald-500 mt-1 mr-3"></i>
            <span>Silakan hubungi admin jika ada kendala atau ubah data</span>
          </li>
        </ul>
      </div>

      <!-- Date Grid -->
      <div class="mb-8">
        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6">
          <h2 class="text-xl font-bold text-gray-800 flex items-center">
            <i class="far fa-calendar-alt mr-3 text-emerald-600"></i>
            Pilih Tanggal Ramadhan
          </h2>
          <div class="mt-3 sm:mt-0 flex space-x-2">
            <button id="user-grid-view-btn" onclick="setUserDateView('grid')"
              class="px-3 py-2 bg-emerald-600 text-white text-sm rounded-lg hover:bg-emerald-700 transition">
              <i class="fas fa-th mr-1"></i>
              Grid
            </button>
            <button id="user-table-view-btn" onclick="setUserDateView('table')"
              class="px-3 py-2 bg-gray-600 text-white text-sm rounded-lg hover:bg-gray-700 transition">
              <i class="fas fa-table mr-1"></i>
              Table
            </button>
          </div>
        </div>

        <!-- Date Grid View -->
        <div id="user-date-grid-view">
          <div id="date-grid"
            class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-7 gap-2 sm:gap-3">
            <!-- Date cards will be generated by JavaScript -->
          </div>
        </div>

        <!-- Date Table View -->
        <div id="user-date-table-view" class="hidden bg-white rounded-xl shadow-lg overflow-hidden">
          <div class="overflow-x-auto">
            <table class="w-full">
              <thead class="bg-gray-50">
                <tr>
                  <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Tanggal & Status
                  </th>
                  <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Pendaftar
                  </th>
                </tr>
              </thead>
              <tbody id="user-date-table-body" class="divide-y divide-gray-200">
                <!-- Date table rows will be generated by JavaScript -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Registration Modal -->
  <div id="registration-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
    <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md modal-animation">
      <div class="p-6">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-xl font-bold text-gray-800" id="modal-title">Daftar Takjil</h3>
          <button onclick="closeModal(true)" class="text-gray-400 hover:text-gray-600">
            <i class="fas fa-times text-2xl"></i>
          </button>
        </div>

        <form id="registration-form" class="space-y-4">
          <input type="hidden" id="selected-date" />

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2"> Nama Keluarga * </label>
            <input type="text" id="family-name" required
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition"
              placeholder="Contoh: Keluarga Ahmad" />
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
              Kode Jalan (WB, PN, MB, LP, PW, SL, LS, Lainnya) *
            </label>

            <!-- Autocomplete container -->
            <div class="relative">
              <input id="house-code" type="text" autocomplete="off" required aria-haspopup="listbox"
                aria-expanded="false"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition"
                placeholder="Ketik atau pilih kode jalan" />

              <div id="house-suggestions" role="listbox"
                class="absolute z-50 mt-1 w-full bg-white rounded-lg shadow-lg hidden max-h-60 overflow-auto"></div>

              <!-- Fallback datalist (kept for simple browsers) -->
              <datalist id="house-code-list" style="display: none"><!-- populated by JS --></datalist>
            </div>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2"> Nomor WhatsApp * </label>
            <input type="tel" id="whatsapp" required
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition"
              placeholder="0812-3456-7890" />
          </div>

          <!-- Error Message -->
          <div id="form-error" class="hidden p-4 bg-red-50 border border-red-200 text-red-700 rounded-lg"></div>

          <!-- Form Actions -->
          <div class="flex space-x-3 pt-4">
            <button type="button" onclick="closeModal(true)"
              class="flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition font-medium">
              Batal
            </button>
            <button type="submit" id="submit-btn"
              class="flex-1 px-4 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition font-medium">
              <span id="submit-text">Daftar</span>
              <span id="submit-loading" class="hidden">
                <i class="fas fa-spinner fa-spin mr-2"></i>
                Menyimpan...
              </span>
            </button>
          </div>
        </form>

        <!-- Full Slot Message (hidden by default) -->
        <div id="full-slot-message" class="hidden"></div>
      </div>
    </div>
  </div>

  <!-- Success Modal -->
  <div id="success-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
    <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md modal-animation p-8 text-center">
      <div class="w-20 h-20 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-6">
        <i class="fas fa-check text-emerald-600 text-3xl"></i>
      </div>
      <h3 class="text-2xl font-bold text-gray-800 mb-3">Pendaftaran Berhasil!</h3>
      <p class="text-gray-600 mb-8" id="success-message"></p>
      <button onclick="closeSuccessModal()"
        class="px-8 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition font-medium">
        Tutup
      </button>
    </div>
  </div>

  <!-- Footer -->
  <footer class="mt-12 pt-8 pb-6 bg-gray-800 text-white">
    <div class="container mx-auto px-4 text-center">
      <p class="text-gray-400">Sistem Pendaftaran Takjil Ramadhan 1447H</p>
      <p class="text-sm text-gray-500 mt-2">Â© 2026 - Tegas Permana</p>
    </div>
  </footer>

  <!-- JavaScript -->
  <script src="js/app.js"></script>
</body>

</html>